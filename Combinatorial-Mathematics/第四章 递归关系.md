### 第四章 递归关系

---

#### 4.1 建立递归关系

初值+递归关系唯一确定一个序列。

一些例题略过。

#### 4.2 常系数线性齐次递归关系

**定义：**序列$(a_0,a_1,\cdots,a_n,\cdots)$中相邻的$k+1$项之间的关系如果为：
$$
a_n=b_1 a_{n-1}+b_2 a_{n-2}+\cdots+b_ka_{n-k},n\geq k
$$
$k$阶常系数递归关系式，与之对应的方程为：
$$
x^k-b_1 x^{k-1}-b_2 x^{k-2}-\cdots b_{k}x^0=0
$$
这个方程称为该递归关系的特征方程。

特征方程的根存在两种情况：

1. 无重复特征根
2. 有重复特征根

##### 1. 考虑无重复特征根的情况

首先假设$q\neq 0$, 我们认为$a_n=q^n$是前面递推关系的一个解当且仅当$q$是前面的特征方程的一个根。

**定理4.2：**如果$q_1,q_2,\cdots,q_k$是递归关系式的特征根，假设$c_1,c_2,\cdots,c_k$是任意的常数，我们可以得到：
$$
a_n=c_1q_1^n+c_2q_2^n+\cdots +c_kq_k^n
$$
是前面第一个递归关系式的解。

**定理4.3：**假设$q_1,q_2,\cdots,q_k$是特征方程互不相同的根，那么：
$$
a_n=c_1q_1^n+c_2q^n+\cdots+c_kq_k^n
$$
是递归关系式的通解。

**例题：**求解下列递归关系式：
$$
\begin{cases}
F_n=F_{n-1}+F_{n-2},&n\geq 2\\
F_0=1,F_1=1
\end{cases}
$$
根据常系数齐次递归关系的解法首先写出特征方程：$x^2-x-1=0$.

求解得到方程的两个互不相同的根为：$\frac{1+\sqrt{5}}{2}$和$\frac{1-\sqrt{5}}{2}$.

根据定理4.3可知这个递归关系式的通解为：
$$
F_n=c_1(\frac{1+\sqrt{5}}{2})^n+c_2(\frac{1-\sqrt{5}}{2})^n
$$
根据给出的初值条件：
$$
\begin{aligned}
c_1+c_2&=1\\
\frac{1+\sqrt{5}}{2}c_1+\frac{1-\sqrt{5}}{2}c_2&=1
\end{aligned}
$$
二元一次方程组不难求出：
$$
c_1=\frac{(1+\sqrt{5})}{2\sqrt{5}},c_2=\frac{(1-\sqrt{5})}{2\sqrt{5}}
$$
从而递归关系式的解为：
$$
F_n=\frac{1}{\sqrt{5}}\left[(\frac{1+\sqrt{5}}{2})^{n+1}+(\frac{1-\sqrt{5}}{2})^{n+1}\right]
$$
假设特征方程出现了复数根的情况，递归关系式的解可以写为另外一种形式。代数中一个实系数多项式的复根的共轭也是该多项式的根，也就是说复根一定是成对出现的，假设$x_1=\delta+i\omega,x_2=\delta-i\omega$是一对复根，那么通解应该对应为：
$$
\begin{aligned}
a_n&=A_1(x_1)^n+A_2(x_2)^n\\
&=A_1(\delta +i\omega)^n+A_2(\delta-i\omega)^n\\
&=c_1\rho^n\cos n\theta+c_2\rho^n\sin n\theta
\end{aligned}
$$
其中：
$$
\rho=\sqrt{\delta^2+\omega^2},\theta=\tan^{-1}(\omega/\delta)\\
c_1=A_1+A_2,c_2=i(A_1-A_2)
$$
**例题：**计算$n\times n$行列式。
$$
\begin{bmatrix}
1&1&0&0&\cdots&0&0&0&0\\
1&1&1&0&\cdots&0&0&0&0\\
0&1&1&1&\cdots&0&0&0&0\\
0&0&1&1&\cdots&0&0&0&0\\
&&&&\vdots\\
0&0&0&0&\cdots&1&1&1&0\\
0&0&0&0&\cdots&0&1&1&1\\
0&0&0&0&\cdots&0&0&1&1\\
\end{bmatrix}_{n\times n}
$$
这是三对角行列式。

按照第一列进行展开可以得到：
$$
\begin{bmatrix}
1&1&0&0&\cdots&0&0&0&0\\
1&1&1&0&\cdots&0&0&0&0\\
0&1&1&1&\cdots&0&0&0&0\\
0&0&1&1&\cdots&0&0&0&0\\
&&&&\vdots\\
0&0&0&0&\cdots&1&1&1&0\\
0&0&0&0&\cdots&0&1&1&1\\
0&0&0&0&\cdots&0&0&1&1\\
\end{bmatrix}_{(n-1)\times (n-1)}
-\begin{bmatrix}
1&0&0&0&\cdots&0&0&0&0\\
1&1&1&0&\cdots&0&0&0&0\\
0&1&1&1&\cdots&0&0&0&0\\
0&0&1&1&\cdots&0&0&0&0\\
&&&&\vdots\\
0&0&0&0&\cdots&1&1&1&0\\
0&0&0&0&\cdots&0&1&1&1\\
0&0&0&0&\cdots&0&0&1&1\\
\end{bmatrix}_{(n-1)\times (n-1)}
$$
将后面要减去的行列式按照第一行进行展开我们可以进一步得到与前面同类型的$(n-2)\times (n-2)$的行列式，从而构建起了递归关系式：
$$
\begin{cases}
a_n=a_{n-1}-a_{n-2},n\geq 3\\
a_1=1,a_2=0
\end{cases}
$$
对应的特征方程为：
$$
x^2-x+1=0
$$
得到两个解为：
$$
x_1=\frac{1+\sqrt{3}i}{2},x_2=\frac{1-\sqrt{3}i}{2}
$$
从而写出通解：
$$
a_n=c_1\cos \frac{n\pi}{3}+c_2\sin\frac{n\pi}{3}
$$
带入初始值得到：
$$
a_n=\cos\frac{n\pi}{3}+\frac{1}{\sqrt{3}}\sin\frac{n\pi}{3}
$$

##### 2. 有重复根的情况

假设递归关系式的特征方程：
$$
x^k-b_1x^{k-1}-b_2x^{k-2}-\cdots b_k=0
$$
有一个$m$重根$q$，则$q^n,nq^n,\cdots,n^{m-1}q^n$都是递归关系式的解。